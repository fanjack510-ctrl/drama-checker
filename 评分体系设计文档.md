# 剧情/情绪类短视频体检器 - 评分体系设计文档

## I. 评分体系总览

### 核心原则
1. **可识别性优先**：评分依赖文本中可识别的信号（冲突词、转折词、情绪词、悬念句式等）
2. **证据驱动**：每个扣分点必须引用原文片段作为证据
3. **稳定性优先**：通过明确的触发条件和分档规则，确保同一脚本多次评估差异小于±5分
4. **可解释性**：每个维度扣分必须说明原因，并给出方向性建议（不提供具体改法）

### 评分维度与权重（总分100分）

| 维度 | 权重 | 满分 | 说明 |
|------|------|------|------|
| **A. 节奏（Rhythm）** | 35% | 35分 | 信息密度、推进速度、是否有拖沓 |
| **B. 情绪曲线（Emotion Curve）** | 35% | 35分 | 情绪变化、转折点、情绪递进 |
| **C. 留存钩子（Retention Triggers）** | 30% | 30分 | 前5秒吸引力、冲突/悬念/反差、结尾落点 |

---

## II. 维度规则细则

### A. 节奏（Rhythm）- 35分

#### A1. 前5秒信息密度（12分）

**触发条件与扣分规则：**
- **0-2分（极低）**：前5秒内无任何冲突词、情绪词、悬念句式、反差对比
  - 扣分：-10分
  - 解释模板："前5秒缺乏明确信息点，容易让观众失去耐心"
  - 证据要求：引用前5秒的原文片段

- **3-5分（低）**：前5秒仅有1个弱信号（如单一情绪词，无冲突）
  - 扣分：-7分
  - 解释模板："前5秒信息密度偏低，吸引力不足"
  - 证据要求：引用前5秒的原文片段

- **6-8分（中）**：前5秒有1-2个中等信号（如情绪词+简单冲突，或单一悬念）
  - 扣分：-3分
  - 解释模板："前5秒有一定吸引力，但可以更强"
  - 证据要求：引用前5秒的原文片段

- **9-12分（高）**：前5秒有2个以上强信号（冲突+情绪+悬念/反差）
  - 扣分：0分
  - 解释模板："前5秒信息密度充足，能快速抓住注意力"

**识别信号词库：**
- 冲突词：但是、可是、然而、竟然、居然、没想到、突然、竟然、居然
- 情绪词：愤怒、震惊、崩溃、绝望、惊喜、激动、紧张、害怕、开心、难过
- 悬念句式：为什么、怎么会、到底、究竟、原来、竟然、居然
- 反差对比：明明...却、本来...结果、以前...现在

#### A2. 中段推进速度（12分）

**触发条件与扣分规则：**
- **0-3分（极慢）**：中段（5秒-总时长70%）存在连续3句以上平铺直叙，无转折、无冲突、无情绪变化
  - 扣分：-9分
  - 解释模板："中段节奏偏慢，存在明显拖沓段落"
  - 证据要求：引用拖沓段落的原文片段（不超过12字）

- **4-6分（慢）**：中段存在连续2句平铺直叙，或信息密度明显下降
  - 扣分：-6分
  - 解释模板："中段节奏可以更快，信息密度有待提升"
  - 证据要求：引用相关段落片段

- **7-9分（中）**：中段有1-2次推进，但节奏不够紧凑
  - 扣分：-3分
  - 解释模板："中段节奏尚可，但仍有优化空间"
  - 证据要求：引用相关段落片段

- **10-12分（快）**：中段节奏紧凑，每10-15秒有推进或变化
  - 扣分：0分
  - 解释模板："中段节奏紧凑，推进有力"

**识别信号：**
- 平铺直叙标记：连续出现"然后"、"接着"、"之后"等连接词，且无冲突/转折
- 推进标记：转折词、冲突词、情绪词、动作词（跑、冲、抓、推等）

#### A3. 整体信息密度（11分）

**触发条件与扣分规则：**
- **0-3分（极低）**：全文无明显冲突、转折、情绪变化，以叙述为主
  - 扣分：-8分
  - 解释模板："整体信息密度过低，缺乏吸引人的元素"
  - 证据要求：引用2处典型段落片段

- **4-6分（低）**：全文仅有1-2个弱信号点
  - 扣分：-5分
  - 解释模板："整体信息密度偏低，可以增加更多冲突或转折"
  - 证据要求：引用1-2处相关片段

- **7-9分（中）**：全文有3-5个信号点，但分布不均
  - 扣分：-2分
  - 解释模板："整体信息密度尚可，但可以更均衡"
  - 证据要求：引用1处相关片段

- **10-11分（高）**：全文信号点密集且分布均匀
  - 扣分：0分
  - 解释模板："整体信息密度充足，节奏感强"

---

### B. 情绪曲线（Emotion Curve）- 35分

#### B1. 情绪转折点（15分）

**触发条件与扣分规则：**
- **0-3分（无转折）**：全文无任何情绪转折（如：平静→愤怒、开心→难过、紧张→放松）
  - 扣分：-12分
  - 解释模板："缺乏情绪转折，情绪曲线平直，难以产生代入感"
  - 证据要求：引用2处情绪状态相同的段落片段

- **4-7分（弱转折）**：全文仅有1次弱转折（情绪变化不明显，或仅从一种情绪过渡到相似情绪）
  - 扣分：-8分
  - 解释模板："情绪转折较弱，变化不够明显"
  - 证据要求：引用转折前后的片段（各不超过12字）

- **8-11分（中等转折）**：全文有1次明显转折，或2次弱转折
  - 扣分：-4分
  - 解释模板："存在情绪转折，但可以更强烈或增加转折次数"
  - 证据要求：引用转折点片段

- **12-15分（强转折）**：全文有2次以上明显转折，或1次强烈转折（情绪反差大）
  - 扣分：0分
  - 解释模板："情绪转折明显，情绪曲线有起伏"

**识别信号：**
- 情绪转折标记：转折词（但是、可是、然而）+ 情绪词变化
- 情绪词库：开心/难过、愤怒/平静、紧张/放松、绝望/希望、震惊/接受

#### B2. 情绪递进（10分）

**触发条件与扣分规则：**
- **0-2分（无递进）**：情绪始终停留在同一强度，无递进或变化
  - 扣分：-8分
  - 解释模板："情绪缺乏递进，始终停留在同一强度"
  - 证据要求：引用2处情绪强度相同的片段

- **3-5分（弱递进）**：情绪有轻微递进，但变化不明显
  - 扣分：-5分
  - 解释模板："情绪递进较弱，可以更明显"
  - 证据要求：引用递进前后的片段

- **6-8分（中等递进）**：情绪有明显递进，但可以更强
  - 扣分：-2分
  - 解释模板："情绪递进尚可，但可以更强烈"
  - 证据要求：引用递进点片段

- **9-10分（强递进）**：情绪有明显递进，强度变化清晰
  - 扣分：0分
  - 解释模板："情绪递进明显，能带动观众情绪"

**识别信号：**
- 递进标记：越来越、逐渐、慢慢、突然、一下子、瞬间
- 强度变化：轻微→中等→强烈（如：有点生气→很生气→愤怒）

#### B3. 情绪多样性（10分）

**触发条件与扣分规则：**
- **0-2分（单一）**：全文仅有一种情绪（如：只有愤怒，或只有开心）
  - 扣分：-8分
  - 解释模板："情绪过于单一，缺乏层次感"
  - 证据要求：引用2处相同情绪的片段

- **3-5分（较少）**：全文有2种情绪，但变化不明显
  - 扣分：-5分
  - 解释模板："情绪种类较少，可以增加更多情绪层次"
  - 证据要求：引用相关片段

- **6-8分（中等）**：全文有3-4种情绪，但分布不均
  - 扣分：-2分
  - 解释模板："情绪多样性尚可，但可以更均衡"
  - 证据要求：引用1处相关片段

- **9-10分（丰富）**：全文有3种以上情绪，且分布合理
  - 扣分：0分
  - 解释模板："情绪层次丰富，能产生代入感"

---

### C. 留存钩子（Retention Triggers）- 30分

#### C1. 前5秒吸引力（15分）

**触发条件与扣分规则：**
- **0-3分（极弱）**：前5秒无冲突、无悬念、无反差、无强情绪
  - 扣分：-12分
  - 解释模板："前5秒缺乏吸引力，容易被划走"
  - 证据要求：引用前5秒的原文片段

- **4-6分（弱）**：前5秒仅有1个弱信号（如：单一情绪词，无冲突）
  - 扣分：-9分
  - 解释模板："前5秒吸引力不足，需要更强的钩子"
  - 证据要求：引用前5秒的原文片段

- **7-9分（中）**：前5秒有1个中等信号（如：冲突或悬念，但不够强烈）
  - 扣分：-6分
  - 解释模板："前5秒有一定吸引力，但可以更强"
  - 证据要求：引用前5秒的原文片段

- **10-12分（强）**：前5秒有1个强信号（强烈冲突/悬念/反差）
  - 扣分：-3分
  - 解释模板："前5秒吸引力较强，能抓住注意力"
  - 证据要求：引用前5秒的原文片段

- **13-15分（极强）**：前5秒有2个以上强信号（冲突+悬念+情绪）
  - 扣分：0分
  - 解释模板："前5秒吸引力极强，能快速抓住观众"

**识别信号：**
- 强信号：强烈冲突（但是+情绪词）、悬念句式（为什么/怎么会/到底）、强烈反差（明明...却）
- 弱信号：单一情绪词、简单叙述

#### C2. 中段留存点（10分）

**触发条件与扣分规则：**
- **0-2分（无留存点）**：中段（5秒-总时长80%）无任何冲突、转折、悬念
  - 扣分：-8分
  - 解释模板："中段缺乏留存点，容易让人中途划走"
  - 证据要求：引用中段典型段落片段

- **3-5分（弱留存点）**：中段有1个弱信号点
  - 扣分：-5分
  - 解释模板："中段留存点较弱，可以增加更多钩子"
  - 证据要求：引用相关片段

- **6-8分（中等留存点）**：中段有1-2个中等信号点
  - 扣分：-2分
  - 解释模板："中段留存点尚可，但可以更强"
  - 证据要求：引用相关片段

- **9-10分（强留存点）**：中段有2个以上信号点，分布合理
  - 扣分：0分
  - 解释模板："中段留存点充足，能持续吸引注意力"

#### C3. 结尾落点（5分）

**触发条件与扣分规则：**
- **0-1分（无落点）**：结尾无情绪收束、无思考点、无共鸣点，突兀结束
  - 扣分：-4分
  - 解释模板："结尾缺乏落点，没有留下印象"
  - 证据要求：引用结尾片段

- **2-3分（弱落点）**：结尾有轻微情绪收束，但不够明显
  - 扣分：-2分
  - 解释模板："结尾落点较弱，可以更明显"
  - 证据要求：引用结尾片段

- **4-5分（强落点）**：结尾有明确的情绪收束、思考点或共鸣点
  - 扣分：0分
  - 解释模板："结尾落点明确，能留下印象"

**识别信号：**
- 落点标记：情绪词（终于、释然、明白、懂了）、思考句式（原来、其实、其实...）、共鸣词（每个人、我们都、生活）

---

## III. JSON Schema

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["totalScore", "overallJudgment", "dimensions", "evidence", "riskPositions", "optimizationDirections"],
  "properties": {
    "totalScore": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "description": "总分（0-100）"
    },
    "overallJudgment": {
      "type": "string",
      "enum": ["好看", "一般", "容易无聊"],
      "description": "整体判断"
    },
    "dimensions": {
      "type": "object",
      "required": ["rhythm", "emotionCurve", "retentionTriggers"],
      "properties": {
        "rhythm": {
          "type": "object",
          "required": ["score", "maxScore", "details"],
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 35
            },
            "maxScore": {
              "type": "number",
              "const": 35
            },
            "details": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["item", "score", "maxScore", "explanation"],
                "properties": {
                  "item": {
                    "type": "string",
                    "enum": ["前5秒信息密度", "中段推进速度", "整体信息密度"]
                  },
                  "score": {
                    "type": "number",
                    "minimum": 0
                  },
                  "maxScore": {
                    "type": "number"
                  },
                  "explanation": {
                    "type": "string",
                    "maxLength": 100
                  }
                }
              }
            }
          }
        },
        "emotionCurve": {
          "type": "object",
          "required": ["score", "maxScore", "details"],
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 35
            },
            "maxScore": {
              "type": "number",
              "const": 35
            },
            "details": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["item", "score", "maxScore", "explanation"],
                "properties": {
                  "item": {
                    "type": "string",
                    "enum": ["情绪转折点", "情绪递进", "情绪多样性"]
                  },
                  "score": {
                    "type": "number",
                    "minimum": 0
                  },
                  "maxScore": {
                    "type": "number"
                  },
                  "explanation": {
                    "type": "string",
                    "maxLength": 100
                  }
                }
              }
            }
          }
        },
        "retentionTriggers": {
          "type": "object",
          "required": ["score", "maxScore", "details"],
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 30
            },
            "maxScore": {
              "type": "number",
              "const": 30
            },
            "details": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["item", "score", "maxScore", "explanation"],
                "properties": {
                  "item": {
                    "type": "string",
                    "enum": ["前5秒吸引力", "中段留存点", "结尾落点"]
                  },
                  "score": {
                    "type": "number",
                    "minimum": 0
                  },
                  "maxScore": {
                    "type": "number"
                  },
                  "explanation": {
                    "type": "string",
                    "maxLength": 100
                  }
                }
              }
            }
          }
        }
      }
    },
    "evidence": {
      "type": "array",
      "maxItems": 6,
      "items": {
        "type": "object",
        "required": ["text", "position", "reason"],
        "properties": {
          "text": {
            "type": "string",
            "maxLength": 12,
            "description": "原文片段（不超过12个汉字）"
          },
          "position": {
            "type": "string",
            "enum": ["前段", "中段", "后段"],
            "description": "位置"
          },
          "reason": {
            "type": "string",
            "maxLength": 50,
            "description": "引用原因"
          }
        }
      }
    },
    "riskPositions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["position", "riskLevel", "description"],
        "properties": {
          "position": {
            "type": "string",
            "enum": ["前段", "中段", "后段"]
          },
          "riskLevel": {
            "type": "string",
            "enum": ["高", "中", "低"]
          },
          "description": {
            "type": "string",
            "maxLength": 80
          }
        }
      }
    },
    "optimizationDirections": {
      "type": "array",
      "maxItems": 4,
      "items": {
        "type": "string",
        "maxLength": 50,
        "description": "方向性建议（不提供具体改法）"
      }
    }
  }
}
```

### JSON 输出示例

```json
{
  "totalScore": 65,
  "overallJudgment": "一般",
  "dimensions": {
    "rhythm": {
      "score": 22,
      "maxScore": 35,
      "details": [
        {
          "item": "前5秒信息密度",
          "score": 5,
          "maxScore": 12,
          "explanation": "前5秒信息密度偏低，吸引力不足"
        },
        {
          "item": "中段推进速度",
          "score": 6,
          "maxScore": 12,
          "explanation": "中段节奏可以更快，信息密度有待提升"
        },
        {
          "item": "整体信息密度",
          "score": 11,
          "maxScore": 11,
          "explanation": "整体信息密度充足，节奏感强"
        }
      ]
    },
    "emotionCurve": {
      "score": 20,
      "maxScore": 35,
      "details": [
        {
          "item": "情绪转折点",
          "score": 7,
          "maxScore": 15,
          "explanation": "情绪转折较弱，变化不够明显"
        },
        {
          "item": "情绪递进",
          "score": 5,
          "maxScore": 10,
          "explanation": "情绪递进较弱，可以更明显"
        },
        {
          "item": "情绪多样性",
          "score": 8,
          "maxScore": 10,
          "explanation": "情绪层次丰富，能产生代入感"
        }
      ]
    },
    "retentionTriggers": {
      "score": 23,
      "maxScore": 30,
      "details": [
        {
          "item": "前5秒吸引力",
          "score": 6,
          "maxScore": 15,
          "explanation": "前5秒吸引力不足，需要更强的钩子"
        },
        {
          "item": "中段留存点",
          "score": 8,
          "maxScore": 10,
          "explanation": "中段留存点尚可，但可以更强"
        },
        {
          "item": "结尾落点",
          "score": 5,
          "maxScore": 5,
          "explanation": "结尾落点明确，能留下印象"
        }
      ]
    }
  },
  "evidence": [
    {
      "text": "今天天气真好",
      "position": "前段",
      "reason": "前5秒缺乏冲突或悬念"
    },
    {
      "text": "然后我就回家了",
      "position": "中段",
      "reason": "平铺直叙，节奏偏慢"
    },
    {
      "text": "心情很平静",
      "position": "中段",
      "reason": "情绪单一，缺乏变化"
    }
  ],
  "riskPositions": [
    {
      "position": "前段",
      "riskLevel": "高",
      "description": "前5秒缺乏吸引力，容易被划走"
    },
    {
      "position": "中段",
      "riskLevel": "中",
      "description": "中段节奏偏慢，存在拖沓"
    }
  ],
  "optimizationDirections": [
    "在开头建立明确的冲突或悬念",
    "增加至少一次情绪或剧情转折",
    "提升中段的信息密度和节奏感"
  ]
}
```

---

## IV. System Prompt

```
你是一个【剧情/情绪类短视频脚本评分专家】。你的任务是严格按照评分规则，对30-90秒的剧情/情绪类短视频脚本进行诊断和评分。

【核心原则】
1. 只做诊断，不参与创作
2. 评分必须依赖可识别的文本信号（冲突词、转折词、情绪词、悬念句式等）
3. 每个扣分点必须引用原文片段作为证据（每段不超过12个汉字，最多6处）
4. 输出必须让普通创作者看懂，使用通俗语言

【评分维度与权重】
- 节奏（Rhythm）：35分
  - 前5秒信息密度：12分
  - 中段推进速度：12分
  - 整体信息密度：11分

- 情绪曲线（Emotion Curve）：35分
  - 情绪转折点：15分
  - 情绪递进：10分
  - 情绪多样性：10分

- 留存钩子（Retention Triggers）：30分
  - 前5秒吸引力：15分
  - 中段留存点：10分
  - 结尾落点：5分

【评分规则】

一、节奏（Rhythm）

A1. 前5秒信息密度（12分）
- 识别信号词库：
  - 冲突词：但是、可是、然而、竟然、居然、没想到、突然
  - 情绪词：愤怒、震惊、崩溃、绝望、惊喜、激动、紧张、害怕、开心、难过
  - 悬念句式：为什么、怎么会、到底、究竟、原来、竟然、居然
  - 反差对比：明明...却、本来...结果、以前...现在

- 评分规则：
  - 0-2分（极低）：前5秒内无任何冲突词、情绪词、悬念句式、反差对比 → 扣10分
  - 3-5分（低）：前5秒仅有1个弱信号（如单一情绪词，无冲突） → 扣7分
  - 6-8分（中）：前5秒有1-2个中等信号 → 扣3分
  - 9-12分（高）：前5秒有2个以上强信号 → 扣0分

A2. 中段推进速度（12分）
- 识别信号：
  - 平铺直叙标记：连续出现"然后"、"接着"、"之后"等连接词，且无冲突/转折
  - 推进标记：转折词、冲突词、情绪词、动作词（跑、冲、抓、推等）

- 评分规则：
  - 0-3分（极慢）：中段存在连续3句以上平铺直叙 → 扣9分
  - 4-6分（慢）：中段存在连续2句平铺直叙 → 扣6分
  - 7-9分（中）：中段有1-2次推进，但节奏不够紧凑 → 扣3分
  - 10-12分（快）：中段节奏紧凑，每10-15秒有推进或变化 → 扣0分

A3. 整体信息密度（11分）
- 评分规则：
  - 0-3分（极低）：全文无明显冲突、转折、情绪变化 → 扣8分
  - 4-6分（低）：全文仅有1-2个弱信号点 → 扣5分
  - 7-9分（中）：全文有3-5个信号点，但分布不均 → 扣2分
  - 10-11分（高）：全文信号点密集且分布均匀 → 扣0分

二、情绪曲线（Emotion Curve）

B1. 情绪转折点（15分）
- 识别信号：
  - 情绪转折标记：转折词（但是、可是、然而）+ 情绪词变化
  - 情绪词库：开心/难过、愤怒/平静、紧张/放松、绝望/希望、震惊/接受

- 评分规则：
  - 0-3分（无转折）：全文无任何情绪转折 → 扣12分
  - 4-7分（弱转折）：全文仅有1次弱转折 → 扣8分
  - 8-11分（中等转折）：全文有1次明显转折，或2次弱转折 → 扣4分
  - 12-15分（强转折）：全文有2次以上明显转折，或1次强烈转折 → 扣0分

B2. 情绪递进（10分）
- 识别信号：
  - 递进标记：越来越、逐渐、慢慢、突然、一下子、瞬间
  - 强度变化：轻微→中等→强烈（如：有点生气→很生气→愤怒）

- 评分规则：
  - 0-2分（无递进）：情绪始终停留在同一强度 → 扣8分
  - 3-5分（弱递进）：情绪有轻微递进，但变化不明显 → 扣5分
  - 6-8分（中等递进）：情绪有明显递进，但可以更强 → 扣2分
  - 9-10分（强递进）：情绪有明显递进，强度变化清晰 → 扣0分

B3. 情绪多样性（10分）
- 评分规则：
  - 0-2分（单一）：全文仅有一种情绪 → 扣8分
  - 3-5分（较少）：全文有2种情绪，但变化不明显 → 扣5分
  - 6-8分（中等）：全文有3-4种情绪，但分布不均 → 扣2分
  - 9-10分（丰富）：全文有3种以上情绪，且分布合理 → 扣0分

三、留存钩子（Retention Triggers）

C1. 前5秒吸引力（15分）
- 识别信号：
  - 强信号：强烈冲突（但是+情绪词）、悬念句式（为什么/怎么会/到底）、强烈反差（明明...却）
  - 弱信号：单一情绪词、简单叙述

- 评分规则：
  - 0-3分（极弱）：前5秒无冲突、无悬念、无反差、无强情绪 → 扣12分
  - 4-6分（弱）：前5秒仅有1个弱信号 → 扣9分
  - 7-9分（中）：前5秒有1个中等信号 → 扣6分
  - 10-12分（强）：前5秒有1个强信号 → 扣3分
  - 13-15分（极强）：前5秒有2个以上强信号 → 扣0分

C2. 中段留存点（10分）
- 评分规则：
  - 0-2分（无留存点）：中段无任何冲突、转折、悬念 → 扣8分
  - 3-5分（弱留存点）：中段有1个弱信号点 → 扣5分
  - 6-8分（中等留存点）：中段有1-2个中等信号点 → 扣2分
  - 9-10分（强留存点）：中段有2个以上信号点，分布合理 → 扣0分

C3. 结尾落点（5分）
- 识别信号：
  - 落点标记：情绪词（终于、释然、明白、懂了）、思考句式（原来、其实）、共鸣词（每个人、我们都、生活）

- 评分规则：
  - 0-1分（无落点）：结尾无情绪收束、无思考点、无共鸣点 → 扣4分
  - 2-3分（弱落点）：结尾有轻微情绪收束，但不够明显 → 扣2分
  - 4-5分（强落点）：结尾有明确的情绪收束、思考点或共鸣点 → 扣0分

【输出要求】

1. 必须严格按照JSON Schema格式输出，不允许偏离
2. 总分 = 各维度得分之和
3. 整体判断（overallJudgment）：
   - 总分≥75：好看
   - 总分60-74：一般
   - 总分<60：容易无聊
4. evidence数组：最多6条，每条text不超过12个汉字，必须引用原文片段
5. riskPositions数组：识别最容易被划走的位置（前段/中段/后段），风险等级（高/中/低）
6. optimizationDirections数组：最多4条，只给方向性建议，不提供具体改法

【禁止事项】

1. 禁止生成任何剧情内容
2. 禁止改写、润色、续写脚本
3. 禁止提供台词示例
4. 禁止使用技术术语，必须用通俗语言
5. 禁止输出非JSON格式内容
6. 禁止在JSON中添加额外字段

【输出格式】

严格按照以下JSON Schema输出：

{
  "totalScore": <0-100的整数>,
  "overallJudgment": "<好看|一般|容易无聊>",
  "dimensions": {
    "rhythm": {
      "score": <0-35的整数>,
      "maxScore": 35,
      "details": [
        {
          "item": "<前5秒信息密度|中段推进速度|整体信息密度>",
          "score": <具体得分>,
          "maxScore": <满分>,
          "explanation": "<一句话解释>"
        }
      ]
    },
    "emotionCurve": {
      "score": <0-35的整数>,
      "maxScore": 35,
      "details": [
        {
          "item": "<情绪转折点|情绪递进|情绪多样性>",
          "score": <具体得分>,
          "maxScore": <满分>,
          "explanation": "<一句话解释>"
        }
      ]
    },
    "retentionTriggers": {
      "score": <0-30的整数>,
      "maxScore": 30,
      "details": [
        {
          "item": "<前5秒吸引力|中段留存点|结尾落点>",
          "score": <具体得分>,
          "maxScore": <满分>,
          "explanation": "<一句话解释>"
        }
      ]
    }
  },
  "evidence": [
    {
      "text": "<原文片段，不超过12个汉字>",
      "position": "<前段|中段|后段>",
      "reason": "<引用原因>"
    }
  ],
  "riskPositions": [
    {
      "position": "<前段|中段|后段>",
      "riskLevel": "<高|中|低>",
      "description": "<风险描述>"
    }
  ],
  "optimizationDirections": [
    "<方向性建议1>",
    "<方向性建议2>"
  ]
}

现在，请对用户提供的脚本进行评分。
```

---

## V. 代码侧校准策略

### 5.1 分数校准规则

```javascript
/**
 * 分数校准函数
 * 确保模型输出的分数在合理范围内，并处理异常情况
 */
function calibrateScore(modelOutput) {
  // 1. 验证总分范围
  if (modelOutput.totalScore < 0) {
    modelOutput.totalScore = 0;
  } else if (modelOutput.totalScore > 100) {
    modelOutput.totalScore = 100;
  }

  // 2. 校准各维度分数
  const dimensions = ['rhythm', 'emotionCurve', 'retentionTriggers'];
  const maxScores = { rhythm: 35, emotionCurve: 35, retentionTriggers: 30 };

  dimensions.forEach(dim => {
    const dimension = modelOutput.dimensions[dim];
    
    // 校准维度总分
    if (dimension.score < 0) {
      dimension.score = 0;
    } else if (dimension.score > maxScores[dim]) {
      dimension.score = maxScores[dim];
    }

    // 校准子项分数
    if (dimension.details && Array.isArray(dimension.details)) {
      dimension.details.forEach(detail => {
        if (detail.score < 0) {
          detail.score = 0;
        } else if (detail.score > detail.maxScore) {
          detail.score = detail.maxScore;
        }
      });

      // 重新计算维度总分（如果子项分数之和与维度总分不一致，以子项之和为准）
      const calculatedScore = dimension.details.reduce((sum, d) => sum + d.score, 0);
      if (Math.abs(dimension.score - calculatedScore) > 2) {
        dimension.score = calculatedScore;
      }
    }
  });

  // 3. 重新计算总分
  const calculatedTotal = 
    modelOutput.dimensions.rhythm.score +
    modelOutput.dimensions.emotionCurve.score +
    modelOutput.dimensions.retentionTriggers.score;
  
  if (Math.abs(modelOutput.totalScore - calculatedTotal) > 3) {
    modelOutput.totalScore = calculatedTotal;
  }

  // 4. 校准整体判断
  if (modelOutput.totalScore >= 75) {
    modelOutput.overallJudgment = '好看';
  } else if (modelOutput.totalScore >= 60) {
    modelOutput.overallJudgment = '一般';
  } else {
    modelOutput.overallJudgment = '容易无聊';
  }

  return modelOutput;
}
```

### 5.2 JSON解析与修复策略

```javascript
/**
 * 解析模型输出，处理非JSON格式或格式错误的情况
 */
function parseModelOutput(rawOutput) {
  let jsonOutput = null;

  // 1. 尝试直接解析JSON
  try {
    jsonOutput = JSON.parse(rawOutput);
  } catch (e) {
    // 2. 尝试提取JSON部分（处理模型可能添加了额外文本）
    const jsonMatch = rawOutput.match(/\{[\s\S]*\}/);
    if (jsonMatch) {
      try {
        jsonOutput = JSON.parse(jsonMatch[0]);
      } catch (e2) {
        // 3. 如果还是失败，返回默认结构
        return getDefaultOutput();
      }
    } else {
      return getDefaultOutput();
    }
  }

  // 3. 验证必需字段
  if (!validateRequiredFields(jsonOutput)) {
    // 缺失字段时，使用默认值填充
    jsonOutput = fillMissingFields(jsonOutput);
  }

  // 4. 校准分数
  jsonOutput = calibrateScore(jsonOutput);

  return jsonOutput;
}

/**
 * 验证必需字段是否存在
 */
function validateRequiredFields(output) {
  const required = [
    'totalScore',
    'overallJudgment',
    'dimensions.rhythm',
    'dimensions.emotionCurve',
    'dimensions.retentionTriggers'
  ];

  for (const field of required) {
    const keys = field.split('.');
    let obj = output;
    for (const key of keys) {
      if (!obj || !obj.hasOwnProperty(key)) {
        return false;
      }
      obj = obj[key];
    }
  }
  return true;
}

/**
 * 填充缺失字段
 */
function fillMissingFields(output) {
  // 确保dimensions存在
  if (!output.dimensions) {
    output.dimensions = {};
  }

  // 确保各维度存在
  const dimensions = ['rhythm', 'emotionCurve', 'retentionTriggers'];
  const maxScores = { rhythm: 35, emotionCurve: 35, retentionTriggers: 30 };

  dimensions.forEach(dim => {
    if (!output.dimensions[dim]) {
      output.dimensions[dim] = {
        score: 0,
        maxScore: maxScores[dim],
        details: []
      };
    }
  });

  // 确保其他字段存在
  if (!output.totalScore) {
    output.totalScore = 0;
  }
  if (!output.overallJudgment) {
    output.overallJudgment = '容易无聊';
  }
  if (!output.evidence) {
    output.evidence = [];
  }
  if (!output.riskPositions) {
    output.riskPositions = [];
  }
  if (!output.optimizationDirections) {
    output.optimizationDirections = [];
  }

  return output;
}

/**
 * 返回默认输出结构（当解析完全失败时）
 */
function getDefaultOutput() {
  return {
    totalScore: 0,
    overallJudgment: '容易无聊',
    dimensions: {
      rhythm: {
        score: 0,
        maxScore: 35,
        details: []
      },
      emotionCurve: {
        score: 0,
        maxScore: 35,
        details: []
      },
      retentionTriggers: {
        score: 0,
        maxScore: 30,
        details: []
      }
    },
    evidence: [],
    riskPositions: [
      {
        position: '前段',
        riskLevel: '高',
        description: '无法解析脚本内容'
      }
    ],
    optimizationDirections: [
      '请检查脚本格式是否正确'
    ]
  };
}
```

### 5.3 证据片段验证与清理

```javascript
/**
 * 验证和清理evidence数组
 */
function validateEvidence(evidence, scriptText) {
  if (!Array.isArray(evidence)) {
    return [];
  }

  const validatedEvidence = [];

  for (const item of evidence) {
    // 验证必需字段
    if (!item.text || !item.position || !item.reason) {
      continue;
    }

    // 限制text长度（不超过12个汉字）
    if (item.text.length > 12) {
      item.text = item.text.substring(0, 12);
    }

    // 验证position枚举值
    const validPositions = ['前段', '中段', '后段'];
    if (!validPositions.includes(item.position)) {
      item.position = '中段'; // 默认值
    }

    // 验证text是否在原文中存在（可选，如果原文可用）
    if (scriptText && !scriptText.includes(item.text)) {
      // 尝试模糊匹配（允许部分匹配）
      const fuzzyMatch = scriptText.includes(item.text.substring(0, 6));
      if (!fuzzyMatch) {
        continue; // 如果完全不存在，跳过这条证据
      }
    }

    validatedEvidence.push(item);
  }

  // 限制最多6条
  return validatedEvidence.slice(0, 6);
}
```

### 5.4 稳定性保障策略

```javascript
/**
 * 多次评估取平均（可选，用于进一步提升稳定性）
 */
async function evaluateWithStability(scriptText, modelCallFn, rounds = 3) {
  const results = [];

  for (let i = 0; i < rounds; i++) {
    try {
      const rawOutput = await modelCallFn(scriptText);
      const parsedOutput = parseModelOutput(rawOutput);
      results.push(parsedOutput.totalScore);
    } catch (error) {
      console.error(`第${i + 1}次评估失败:`, error);
    }
  }

  if (results.length === 0) {
    return null;
  }

  // 计算平均值
  const avgScore = results.reduce((sum, score) => sum + score, 0) / results.length;

  // 如果分数差异过大（标准差>5），使用中位数
  const sortedScores = [...results].sort((a, b) => a - b);
  const medianScore = sortedScores[Math.floor(sortedScores.length / 2)];
  
  const variance = results.reduce((sum, score) => sum + Math.pow(score - avgScore, 2), 0) / results.length;
  const stdDev = Math.sqrt(variance);

  // 如果标准差>5，使用中位数；否则使用平均值
  const finalScore = stdDev > 5 ? medianScore : Math.round(avgScore);

  // 返回最后一次评估的完整结果，但总分使用校准后的值
  const finalResult = parseModelOutput(await modelCallFn(scriptText));
  finalResult.totalScore = finalScore;
  finalResult.overallJudgment = finalScore >= 75 ? '好看' : (finalScore >= 60 ? '一般' : '容易无聊');

  return finalResult;
}
```

### 5.5 完整调用流程示例

```javascript
/**
 * 完整的分析流程
 */
async function analyzeScript(scriptText) {
  // 1. 验证输入
  if (!scriptText || scriptText.trim().length === 0) {
    throw new Error('脚本内容不能为空');
  }

  // 2. 调用模型API（示例）
  const rawOutput = await callModelAPI(scriptText);

  // 3. 解析和修复JSON
  let parsedOutput = parseModelOutput(rawOutput);

  // 4. 验证和清理evidence
  parsedOutput.evidence = validateEvidence(parsedOutput.evidence, scriptText);

  // 5. 最终校准
  parsedOutput = calibrateScore(parsedOutput);

  // 6. 返回结果
  return parsedOutput;
}

/**
 * 调用模型API的示例函数（需要根据实际API替换）
 */
async function callModelAPI(scriptText) {
  // 这里替换为实际的API调用
  // 例如：OpenAI API, Claude API, 或其他大模型API
  const response = await fetch('YOUR_API_ENDPOINT', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      model: 'your-model-name',
      messages: [
        {
          role: 'system',
          content: SYSTEM_PROMPT // 使用上面定义的System Prompt
        },
        {
          role: 'user',
          content: `请对以下脚本进行评分：\n\n${scriptText}`
        }
      ],
      temperature: 0.3, // 降低temperature以提高稳定性
      response_format: { type: 'json_object' } // 如果API支持，强制JSON输出
    })
  });

  const data = await response.json();
  return data.choices[0].message.content;
}
```

---

## 总结

本评分体系设计包含：

1. **明确的评分规则**：每个维度都有具体的触发条件和扣分幅度
2. **可识别的信号词库**：依赖文本中的冲突词、转折词、情绪词等
3. **结构化输出**：JSON Schema确保输出格式统一
4. **系统提示词**：详细说明评分规则，确保模型按规则执行
5. **代码侧校准**：处理异常情况，确保分数稳定在合理范围

通过以上设计，可以实现：
- 同一脚本多次评估，分数差异小于±5分
- 每个扣分点都有原文证据支撑
- 输出结果可被前端直接渲染
- 评分过程可解释、可追溯
